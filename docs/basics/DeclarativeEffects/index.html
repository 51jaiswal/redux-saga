<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redux-Saga Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redux-Saga Blog Atom Feed"><title data-react-helmet="true">Declarative Effects | Redux-Saga</title><meta data-react-helmet="true" property="og:image" content="https://redux-saga.js.org//img/Redux-Saga-Logo-Portrait.png"><meta data-react-helmet="true" name="twitter:image" content="https://redux-saga.js.org//img/Redux-Saga-Logo-Portrait.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Redux-Saga"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Declarative Effects | Redux-Saga"><meta data-react-helmet="true" name="description" content="Declarative Effects"><meta data-react-helmet="true" property="og:description" content="Declarative Effects"><meta data-react-helmet="true" property="og:url" content="https://redux-saga.js.org//docs/basics/DeclarativeEffects"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://redux-saga.js.org//docs/basics/DeclarativeEffects"><link rel="stylesheet" href="/styles.1ff216e0.css">
<link rel="stylesheet" href="/main.d9a8fb9f.css">
<link rel="preload" href="/styles.1c0a7872.js" as="script">
<link rel="preload" href="/runtime~main.11099d5f.js" as="script">
<link rel="preload" href="/main.dda7169f.js" as="script">
<link rel="preload" href="/1.72612929.js" as="script">
<link rel="preload" href="/34.30532b93.js" as="script">
<link rel="preload" href="/35.abdc7976.js" as="script">
<link rel="preload" href="/935f2afb.804f3d35.js" as="script">
<link rel="preload" href="/33.45da8d43.js" as="script">
<link rel="preload" href="/a0ed4192.a98fb215.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Redux-Saga</strong></a><a class="navbar__item navbar__link" href="/docs/introduction/GettingStarted">Introduction</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/basics/DeclarativeEffects">Basics</a><a class="navbar__item navbar__link" href="/docs/advanced/Channels">Advanced</a><a class="navbar__item navbar__link" href="/docs/api">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://www.npmjs.com/package/redux-saga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">npm</a><a href="https://cdnjs.com/libraries/redux-saga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">cdnjs</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Redux-Saga</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction/GettingStarted">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/basics/DeclarativeEffects">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/advanced/Channels">Advanced</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/api">API</a></li><li class="menu__list-item"><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://www.npmjs.com/package/redux-saga" target="_blank" rel="noopener noreferrer" class="menu__link">npm</a></li><li class="menu__list-item"><a href="https://cdnjs.com/libraries/redux-saga" target="_blank" rel="noopener noreferrer" class="menu__link">cdnjs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/About">About</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/GettingStarted">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/BeginnerTutorial">Beginner Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/SagaBackground">Saga Background</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Basics Concepts</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/basics/DeclarativeEffects">Declarative Effects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basics/DispatchingActions">Dispatching Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basics/Effect">Effect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basics/ErrorHandling">Error Handling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basics/UsingSagaHelpers">Using Saga Helpers</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/Channels">Channels</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/ComposingSagas">Composing Sagas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/Concurrency">Concurrency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/ForkModel">Fork Model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/FutureActions">Future Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/NonBlockingCalls">Non-Blocking Calls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/RacingEffects">Racing Effects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/RootSaga">Root Saga</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/RunningTasksInParallel">Running Tasks In Parallel</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/TaskCancellation">Task Cancellation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/Testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/advanced/UsingRunSaga">Using Run Saga</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/recipes">Recipes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ExternalResources">External Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Glossary">Glossary</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/api">API Reference</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="declarative-effects"></a>Declarative Effects<a class="hash-link" href="#declarative-effects" title="Direct link to heading">#</a></h1><p>In <code>redux-saga</code>, Sagas are implemented using Generator functions. To express the Saga logic, we yield plain JavaScript Objects from the Generator. We call those Objects <a href="https://redux-saga.js.org/docs/api/#effect-creators" target="_blank" rel="noopener noreferrer"><em>Effects</em></a>. An Effect is an object that contains some information to be interpreted by the middleware. You can view Effects like instructions to the middleware to perform some operation (e.g., invoke some asynchronous function, dispatch an action to the store, etc.).</p><p>To create Effects, you use the functions provided by the library in the <code>redux-saga/effects</code> package.</p><p>In this section and the following, we will introduce some basic Effects. And see how the concept allows the Sagas to be easily tested.</p><p>Sagas can yield Effects in multiple forms. The easiest way is to yield a Promise.</p><p>For example suppose we have a Saga that watches a <code>PRODUCTS_REQUESTED</code> action. On each matching action, it starts a task to fetch a list of products from a server.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> takeEvery </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Api</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;./path/to/api&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">watchFetchProducts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">takeEvery</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;PRODUCTS_REQUESTED&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> fetchProducts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fetchProducts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> products </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">fetch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;/products&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(227, 98, 9)">console</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">log</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">products</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In the example above, we are invoking <code>Api.fetch</code> directly from inside the Generator (In Generator functions, any expression at the right of <code>yield</code> is evaluated then the result is yielded to the caller).</p><p><code>Api.fetch(&#x27;/products&#x27;)</code> triggers an AJAX request and returns a Promise that will resolve with the resolved response, the AJAX request will be executed immediately. Simple and idiomatic, but...</p><p>Suppose we want to test the generator above:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> iterator </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fetchProducts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">assert</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">deepEqual</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">iterator</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">next</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">value</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">??</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// what do we expect ?</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We want to check the result of the first value yielded by the generator. In our case it&#x27;s the result of running <code>Api.fetch(&#x27;/products&#x27;)</code> which is a Promise . Executing the real service during tests is neither a viable nor practical approach, so we have to <em>mock</em> the <code>Api.fetch</code> function, i.e. we&#x27;ll have to replace the real function with a fake one which doesn&#x27;t actually run the AJAX request but only checks that we&#x27;ve called <code>Api.fetch</code> with the right arguments (<code>&#x27;/products&#x27;</code> in our case).</p><p>Mocks make testing more difficult and less reliable. On the other hand, functions that return values are easier to test, since we can use a simple <code>equal()</code> to check the result. This is the way to write the most reliable tests.</p><p>Not convinced? I encourage you to read <a href="https://medium.com/javascript-scene/what-every-unit-test-needs-f6cd34d9836d#.4ttnnzpgc" target="_blank" rel="noopener noreferrer">Eric Elliott&#x27;s article</a>:</p><blockquote><p>(...)<code>equal()</code>, by nature answers the two most important questions every unit test must answer,
but most donâ€™t:</p><ul><li>What is the actual output?</li><li>What is the expected output?</li></ul><p>If you finish a test without answering those two questions, you donâ€™t have a real unit test. You have a sloppy, half-baked test.</p></blockquote><p>What we actually need to do is make sure the <code>fetchProducts</code> task yields a call with the right function and the right arguments.</p><p>Instead of invoking the asynchronous function directly from inside the Generator, <strong>we can yield only a description of the function invocation</strong>. i.e. We&#x27;ll yield an object which looks like</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token comment" style="color:rgb(106, 153, 85)">// Effect -&gt; call the function Api.fetch with `./products` as argument</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    fn</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">fetch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    args</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&#x27;./products&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Put another way, the Generator will yield plain Objects containing <em>instructions</em>, and the <code>redux-saga</code> middleware will take care of executing those instructions and giving back the result of their execution to the Generator. This way, when testing the Generator, all we need to do is to check that it yields the expected instruction by doing a simple <code>deepEqual</code> on the yielded Object.</p><p>For this reason, the library provides a different way to perform asynchronous calls.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> call </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fetchProducts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> products </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">fetch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;/products&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We&#x27;re using now the <code>call(fn, ...args)</code> function. <strong>The difference from the preceding example is that now we&#x27;re not executing the fetch call immediately, instead, <code>call</code> creates a description of the effect</strong>. Just as in Redux you use action creators to create a plain object describing the action that will get executed by the Store, <code>call</code> creates a plain object describing the function call. The redux-saga middleware takes care of executing the function call and resuming the generator with the resolved response.</p><p>This allows us to easily test the Generator outside the Redux environment. Because <code>call</code> is just a function which returns a plain Object.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> call </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Api</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> iterator </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fetchProducts</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// expects a call instruction</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">assert</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">deepEqual</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  iterator</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">next</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">value</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">fetch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;/products&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token string">&quot;fetchProducts should yield an Effect call(Api.fetch, &#x27;./products&#x27;)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now we don&#x27;t need to mock anything, and a basic equality test will suffice.</p><p>The advantage of those <em>declarative calls</em> is that we can test all the logic inside a Saga by iterating over the Generator and doing a <code>deepEqual</code> test on the values yielded successively. This is a real benefit, as your complex asynchronous operations are no longer black boxes, and you can test in detail their operational logic no matter how complex it is.</p><p><code>call</code> also supports invoking object methods, you can provide a <code>this</code> context to the invoked functions using the following form:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">obj</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">method</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> arg1</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> arg2</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// as if we did obj.method(arg1, arg2 ...)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>apply</code> is an alias for the method invocation form</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">apply</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">method</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">arg1</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> arg2</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>call</code> and <code>apply</code> are well suited for functions that return Promise results. Another function <code>cps</code> can be used to handle Node style functions (e.g. <code>fn(...args, callback)</code> where <code>callback</code> is of the form <code>(error, result) =&gt; ()</code>). <code>cps</code> stands for Continuation Passing Style.</p><p>For example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> cps </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> content </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cps</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">readFile</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;/path/to/file&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>And of course you can test it just like you test <code>call</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> cps </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> iterator </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fetchSaga</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">assert</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">deepEqual</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">iterator</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token method function property-access" style="color:rgb(111, 66, 193)">next</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">value</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cps</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">readFile</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;/path/to/file&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>cps</code> also supports the same method invocation form as <code>call</code>.</p><p>A full list of declarative effects can be found in the <a href="https://redux-saga.js.org/docs/api/#effect-creators" target="_blank" rel="noopener noreferrer">API reference</a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redux-saga/redux-saga/edit/master/docs/../docs/basics/DeclarativeEffects.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/introduction/SagaBackground"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Saga Background</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/basics/DispatchingActions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dispatching Actions Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/introduction/BeginnerTutorial">Introduction</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/basics/DeclarativeEffects">Basic Concepts</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/advanced/Channels">Advanced Concepts</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/api">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/Glossary">Glossary</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/Troubleshooting">Troubleshooting</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/ExternalResources">External Resources</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Sources</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://www.npmjs.com/package/redux-saga" target="_blank" rel="noopener noreferrer" class="footer__link-item">npm</a></li><li class="footer__item"><a href="https://cdnjs.com/libraries/redux-saga" target="_blank" rel="noopener noreferrer" class="footer__link-item">cdnjs</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Redux-Saga Logo" src="/img/Redux-Saga-Logo-Landscape.png"></div><div class="footer__copyright">Copyright Â© 2021 Redux-Saga. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.1c0a7872.js"></script>
<script src="/runtime~main.11099d5f.js"></script>
<script src="/main.dda7169f.js"></script>
<script src="/1.72612929.js"></script>
<script src="/34.30532b93.js"></script>
<script src="/35.abdc7976.js"></script>
<script src="/935f2afb.804f3d35.js"></script>
<script src="/33.45da8d43.js"></script>
<script src="/a0ed4192.a98fb215.js"></script>
</body>
</html>