<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redux-Saga Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redux-Saga Blog Atom Feed"><title data-react-helmet="true">Non-Blocking Calls | Redux-Saga</title><meta data-react-helmet="true" property="og:image" content="https://redux-saga.js.org//img/Redux-Saga-Logo-Portrait.png"><meta data-react-helmet="true" name="twitter:image" content="https://redux-saga.js.org//img/Redux-Saga-Logo-Portrait.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Redux-Saga"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Non-Blocking Calls | Redux-Saga"><meta data-react-helmet="true" name="description" content="Non-blocking calls"><meta data-react-helmet="true" property="og:description" content="Non-blocking calls"><meta data-react-helmet="true" property="og:url" content="https://redux-saga.js.org//docs/advanced/NonBlockingCalls"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://redux-saga.js.org//docs/advanced/NonBlockingCalls"><link rel="stylesheet" href="/styles.1ff216e0.css">
<link rel="stylesheet" href="/main.d9a8fb9f.css">
<link rel="preload" href="/styles.1c0a7872.js" as="script">
<link rel="preload" href="/runtime~main.11099d5f.js" as="script">
<link rel="preload" href="/main.dda7169f.js" as="script">
<link rel="preload" href="/1.72612929.js" as="script">
<link rel="preload" href="/34.30532b93.js" as="script">
<link rel="preload" href="/35.abdc7976.js" as="script">
<link rel="preload" href="/935f2afb.804f3d35.js" as="script">
<link rel="preload" href="/33.45da8d43.js" as="script">
<link rel="preload" href="/c4357eee.206c1329.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Redux-Saga</strong></a><a class="navbar__item navbar__link" href="/docs/introduction/GettingStarted">Introduction</a><a class="navbar__item navbar__link" href="/docs/basics/DeclarativeEffects">Basics</a><a class="navbar__item navbar__link" href="/docs/advanced/Channels">Advanced</a><a class="navbar__item navbar__link" href="/docs/api">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://www.npmjs.com/package/redux-saga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">npm</a><a href="https://cdnjs.com/libraries/redux-saga" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">cdnjs</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/Redux-Saga-Logo.png" alt="Redux-Saga Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Redux-Saga</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/introduction/GettingStarted">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/basics/DeclarativeEffects">Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/advanced/Channels">Advanced</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/api">API</a></li><li class="menu__list-item"><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://www.npmjs.com/package/redux-saga" target="_blank" rel="noopener noreferrer" class="menu__link">npm</a></li><li class="menu__list-item"><a href="https://cdnjs.com/libraries/redux-saga" target="_blank" rel="noopener noreferrer" class="menu__link">cdnjs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/About">About</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/GettingStarted">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/BeginnerTutorial">Beginner Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction/SagaBackground">Saga Background</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basics Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/basics/DeclarativeEffects">Declarative Effects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/basics/DispatchingActions">Dispatching Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/basics/Effect">Effect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/basics/ErrorHandling">Error Handling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/basics/UsingSagaHelpers">Using Saga Helpers</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Advanced Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/Channels">Channels</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/ComposingSagas">Composing Sagas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/Concurrency">Concurrency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/ForkModel">Fork Model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/FutureActions">Future Actions</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/advanced/NonBlockingCalls">Non-Blocking Calls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/RacingEffects">Racing Effects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/RootSaga">Root Saga</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/RunningTasksInParallel">Running Tasks In Parallel</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/TaskCancellation">Task Cancellation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/Testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced/UsingRunSaga">Using Run Saga</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/recipes">Recipes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/ExternalResources">External Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/Glossary">Glossary</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/api">API Reference</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="non-blocking-calls"></a>Non-blocking calls<a class="hash-link" href="#non-blocking-calls" title="Direct link to heading">#</a></h1><p>In the previous section, we saw how the <code>take</code> Effect allows us to better describe a non-trivial flow in a central place.</p><p>Revisiting the login flow example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">loginFlow</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;LOGIN&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// ... perform the login logic</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;LOGOUT&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// ... perform the logout logic</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let&#x27;s complete the example and implement the actual login/logout logic. Suppose we have an API which permits us to authorize the user on a remote server. If the authorization is successful, the server will return an authorization token which will be stored by our application using DOM storage (assume our API provides another service for DOM storage).</p><p>When the user logs out, we&#x27;ll delete the authorization token stored previously.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="first-try"></a>First try<a class="hash-link" href="#first-try" title="Direct link to heading">#</a></h3><p>So far we have all Effects needed to implement the above flow. We can wait for specific actions in the store using the <code>take</code> Effect. We can make asynchronous calls using the <code>call</code> Effect. Finally, we can dispatch actions to the store using the <code>put</code> Effect.</p><p>Let&#x27;s give it a try:</p><blockquote><p>Note: the code below has a subtle issue. Make sure to read the section until the end.</p></blockquote><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> take</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> call</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> put </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Api</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">user</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token parameter"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">put</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_SUCCESS&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> token</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">catch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">put</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_ERROR&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">loginFlow</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;LOGIN_REQUEST&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">storeItem</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;LOGOUT&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">clearItem</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;token&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>First, we created a separate Generator <code>authorize</code> which will perform the actual API call and notify the Store upon success.</p><p>The <code>loginFlow</code> implements its entire flow inside a <code>while (true)</code> loop, which means once we reach the last step in the flow (<code>LOGOUT</code>) we start a new iteration by waiting for a new <code>LOGIN_REQUEST</code> action.</p><p><code>loginFlow</code> first waits for a <code>LOGIN_REQUEST</code> action. Then, it retrieves the credentials in the action payload (<code>user</code> and <code>password</code>) and makes a <code>call</code> to the <code>authorize</code> task.</p><p>As you noted, <code>call</code> isn&#x27;t only for invoking functions returning Promises. We can also use it to invoke other Generator functions. In the above example, <strong><code>loginFlow</code> will wait for authorize until it terminates and returns</strong> (i.e. after performing the api call, dispatching the action and then returning the token to <code>loginFlow</code>).</p><p>If the API call succeeds, <code>authorize</code> will dispatch a <code>LOGIN_SUCCESS</code> action then return the fetched token. If it results in an error, it&#x27;ll dispatch a <code>LOGIN_ERROR</code> action.</p><p>If the call to <code>authorize</code> is successful, <code>loginFlow</code> will store the returned token in the DOM storage and wait for a <code>LOGOUT</code> action. When the user logs out, we remove the stored token and wait for a new user login.</p><p>If the <code>authorize</code> failed, it&#x27;ll return <code>undefined</code>, which will cause <code>loginFlow</code> to skip the previous process and wait for a new <code>LOGIN_REQUEST</code> action.</p><p>Observe how the entire logic is stored in one place. A new developer reading our code doesn&#x27;t have to travel between various places to understand the control flow. It&#x27;s like reading a synchronous algorithm: steps are laid out in their natural order. And we have functions which call other functions and wait for their results.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="but-there-is-still-a-subtle-issue-with-the-above-approach"></a>But there is still a subtle issue with the above approach<a class="hash-link" href="#but-there-is-still-a-subtle-issue-with-the-above-approach" title="Direct link to heading">#</a></h3><p>Suppose that when the <code>loginFlow</code> is waiting for the following call to resolve:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">loginFlow</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The user clicks on the <code>Logout</code> button causing a <code>LOGOUT</code> action to be dispatched.</p><p>The following example illustrates the hypothetical sequence of the events:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">UI                              loginFlow</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">--------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">LOGIN_REQUEST...................call authorize.......... waiting to resolve</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">........................................................</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">........................................................</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">LOGOUT.................................................. missed!</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">........................................................</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">................................authorize returned...... dispatch a `LOGIN_SUCCESS`!!</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">........................................................</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>When <code>loginFlow</code> is blocked on the <code>authorize</code> call, an eventual <code>LOGOUT</code> occurring in between the call and the response will be missed, because <code>loginFlow</code> hasn&#x27;t yet performed the <code>yield take(&#x27;LOGOUT&#x27;)</code>.</p><p>The problem with the above code is that <code>call</code> is a blocking Effect. i.e. the Generator can&#x27;t perform/handle anything else until the call terminates. But in our case we do not only want <code>loginFlow</code> to execute the authorization call, but also watch for an eventual <code>LOGOUT</code> action that may occur in the middle of this call. That&#x27;s because <code>LOGOUT</code> is <em>concurrent</em> to the <code>authorize</code> call.</p><p>So what&#x27;s needed is some way to start <code>authorize</code> without blocking so <code>loginFlow</code> can continue and watch for an eventual/concurrent <code>LOGOUT</code> action.</p><p>To express non-blocking calls, the library provides another Effect: <a href="https://redux-saga.js.org/docs/api/index.html#forkfn-args" target="_blank" rel="noopener noreferrer"><code>fork</code></a>. When we fork a <em>task</em>, the task is started in the background and the caller can continue its flow without waiting for the forked task to terminate.</p><p>So in order for <code>loginFlow</code> to not miss a concurrent <code>LOGOUT</code>, we must not <code>call</code> the <code>authorize</code> task, instead we have to <code>fork</code> it.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> fork</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> call</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> take</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> put </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">loginFlow</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// non-blocking call, what&#x27;s the returned value here ?</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">??</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fork</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(0, 92, 197)">...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The issue now is since our <code>authorize</code> action is started in the background, we can&#x27;t get the <code>token</code> result (because we&#x27;d have to wait for it). So we need to move the token storage operation into the <code>authorize</code> task.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> fork</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> call</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> take</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> put </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Api</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">user</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token parameter"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">put</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_SUCCESS&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">storeItem</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">catch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">put</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_ERROR&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">loginFlow</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;LOGIN_REQUEST&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fork</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&#x27;LOGOUT&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_ERROR&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">clearItem</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;token&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We&#x27;re also doing <code>yield take([&#x27;LOGOUT&#x27;, &#x27;LOGIN_ERROR&#x27;])</code>. It means we are watching for 2 concurrent actions:</p><ul><li><p>If the <code>authorize</code> task succeeds before the user logs out, it&#x27;ll dispatch a <code>LOGIN_SUCCESS</code> action, then terminate. Our <code>loginFlow</code> saga will then wait only for a future <code>LOGOUT</code> action (because <code>LOGIN_ERROR</code> will never happen).</p></li><li><p>If the <code>authorize</code> fails before the user logs out, it will dispatch a <code>LOGIN_ERROR</code> action, then terminate. So <code>loginFlow</code> will take the <code>LOGIN_ERROR</code> before the <code>LOGOUT</code> then it will enter in a another <code>while</code> iteration and will wait for the next <code>LOGIN_REQUEST</code> action.</p></li><li><p>If the user logs out before the <code>authorize</code> terminates, then <code>loginFlow</code> will take a <code>LOGOUT</code> action and also wait for the next <code>LOGIN_REQUEST</code>.</p></li></ul><p>Note the call for <code>Api.clearItem</code> is supposed to be idempotent. It&#x27;ll have no effect if no token was stored by the <code>authorize</code> call. <code>loginFlow</code> makes sure no token will be in the storage before waiting for the next login.</p><p>But we&#x27;re not yet done. If we take a <code>LOGOUT</code> in the middle of an API call, we have to <strong>cancel</strong> the <code>authorize</code> process, otherwise we&#x27;ll have 2 concurrent tasks evolving in parallel: The <code>authorize</code> task will continue running and upon a successful (resp. failed) result, will dispatch a <code>LOGIN_SUCCESS</code> (resp. a <code>LOGIN_ERROR</code>) action leading to an inconsistent state.</p><p>In order to cancel a forked task, we use a dedicated Effect <a href="https://redux-saga.js.org/docs/api/index.html#canceltask" target="_blank" rel="noopener noreferrer"><code>cancel</code></a></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> take</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> put</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> call</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> fork</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> cancel </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ...</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">loginFlow</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token boolean" style="color:rgb(0, 92, 197)">true</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&#x27;LOGIN_REQUEST&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// fork return a Task object</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> task </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">fork</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> action </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">take</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&#x27;LOGOUT&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_ERROR&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">action</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">type</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">===</span><span class="token plain"> </span><span class="token string">&#x27;LOGOUT&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cancel</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">task</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">clearItem</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token string">&#x27;token&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>yield fork</code> results in a <a href="https://redux-saga.js.org/docs/api/index.html#task" target="_blank" rel="noopener noreferrer">Task Object</a>. We assign the returned object into a local constant <code>task</code>. Later if we take a <code>LOGOUT</code> action, we pass that task to the <code>cancel</code> Effect. If the task is still running, it&#x27;ll be aborted. If the task has already completed then nothing will happen and the cancellation will result in a no-op. And finally, if the task completed with an error, then we do nothing, because we know the task already completed.</p><p>We are <em>almost</em> done (concurrency is not that easy; you have to take it seriously).</p><p>Suppose that when we receive a <code>LOGIN_REQUEST</code> action, our reducer sets some <code>isLoginPending</code> flag to true so it can display some message or spinner in the UI. If we get a <code>LOGOUT</code> in the middle of an API call and abort the task by <em>killing it</em> (i.e. the task is stopped right away), then we may end up again with an inconsistent state. We&#x27;ll still have <code>isLoginPending</code> set to true and our reducer will be waiting for an outcome action (<code>LOGIN_SUCCESS</code> or <code>LOGIN_ERROR</code>).</p><p>Fortunately, the <code>cancel</code> Effect won&#x27;t brutally kill our <code>authorize</code> task. Instead, it&#x27;ll give it a chance to perform its cleanup logic. The cancelled task can handle any cancellation logic (as well as any other type of completion) in its <code>finally</code> block. Since a finally block execute on any type of completion (normal return, error, or forced cancellation), there is an Effect <code>cancelled</code> which you can use if you want handle cancellation in a special way:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token imports"> take</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> call</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> put</span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token imports"> cancelled </span><span class="token imports punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;redux-saga/effects&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword module" style="color:#e3116c">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Api</span><span class="token plain"> </span><span class="token keyword module" style="color:#e3116c">from</span><span class="token plain"> </span><span class="token string">&#x27;...&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">function</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">user</span><span class="token parameter punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token parameter"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#e3116c">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">const</span><span class="token plain"> token </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">authorize</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> password</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">put</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_SUCCESS&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">call</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token maybe-class-name">Api</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">storeItem</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> token</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">catch</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">put</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain">type</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string">&#x27;LOGIN_ERROR&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#e3116c">finally</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token keyword control-flow" style="color:#e3116c">yield</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cancelled</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token comment" style="color:rgb(106, 153, 85)">// ... put special cancellation handling code here</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You may have noticed that we haven&#x27;t done anything about clearing our <code>isLoginPending</code> state. For that, there are at least two possible solutions:</p><ul><li>dispatch a dedicated action <code>RESET_LOGIN_PENDING</code></li><li>make the reducer clear the <code>isLoginPending</code> on a <code>LOGOUT</code> action</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redux-saga/redux-saga/edit/master/docs/../docs/advanced/NonBlockingCalls.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/advanced/FutureActions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Future Actions</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/advanced/RacingEffects"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Racing Effects Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#first-try" class="table-of-contents__link">First try</a></li><li><a href="#but-there-is-still-a-subtle-issue-with-the-above-approach" class="table-of-contents__link">But there is still a subtle issue with the above approach</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/introduction/BeginnerTutorial">Introduction</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/basics/DeclarativeEffects">Basic Concepts</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/advanced/Channels">Advanced Concepts</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/api">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/Glossary">Glossary</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/Troubleshooting">Troubleshooting</a></li><li class="footer__item"><a class="footer__link-item" target="_self" href="/docs/ExternalResources">External Resources</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Sources</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://www.npmjs.com/package/redux-saga" target="_blank" rel="noopener noreferrer" class="footer__link-item">npm</a></li><li class="footer__item"><a href="https://cdnjs.com/libraries/redux-saga" target="_blank" rel="noopener noreferrer" class="footer__link-item">cdnjs</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Redux-Saga Logo" src="/img/Redux-Saga-Logo-Landscape.png"></div><div class="footer__copyright">Copyright Â© 2021 Redux-Saga. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.1c0a7872.js"></script>
<script src="/runtime~main.11099d5f.js"></script>
<script src="/main.dda7169f.js"></script>
<script src="/1.72612929.js"></script>
<script src="/34.30532b93.js"></script>
<script src="/35.abdc7976.js"></script>
<script src="/935f2afb.804f3d35.js"></script>
<script src="/33.45da8d43.js"></script>
<script src="/c4357eee.206c1329.js"></script>
</body>
</html>